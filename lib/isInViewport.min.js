(function(e){e.fn.isInViewport=function t(){var n;if(arguments.length){for(var r=0;r<arguments.length;r++){if(toString.call(arguments[r])=="[object Function]"||typeof arguments[r]==="function")var i=arguments[r];else if(arguments[r]===Object(arguments[r]))var s=arguments[r]}}if(s){s.tolerance=Math.round(parseFloat(s.tolerance));if(isNaN(s.tolerance))s.tolerance=0;if(typeof s.debug!=="boolean")s.debug=false}t.setting=e.extend({tolerance:0,debug:false},s);t.debug=function(n,r,i,s,o){console.log("---------------------------------------");console.log("index: "+n);console.log("div: "+r);console.log("top: "+i);console.log("bottom: "+s);console.log("tolerance: "+t.setting.tolerance);console.log("end of page: "+o);console.log("scrollTop: "+e(window).scrollTop());console.log("doc height:"+e(document).height());console.log("windowHeight using $(window).height(): "+e(window).height())};t.checkTolorance=function(e,n){if(e>=0)if(e<=t.setting.tolerance)return true;else return false;else if(n>t.setting.tolerance)return true;else return false};t.checkToloranceDefault=function(t){if(t>=0&&t<=e(window).height())return true;else return false};t.checkEndOfPage=function(e){if(t.elementsAfterCurrent[e].length===1||!t.elementsAfterCurrent[e].length)if(top<0)return false;else return true};e.each(this,function(n){var r=e(this).get(0),s=r.getBoundingClientRect(),o=s.top,u=s.bottom,a=e(window).scrollTop()===e(document).height()-e(window).height()?true:false,f=false;t.elementsAfterCurrent=t.elementsAfterCurrent||{};t.elementsAfterCurrent[n]=t.elementsAfterCurrent[n]||e(this).nextAll();if(t.setting.debug)t.debug(n,r.text().trim(),o,u,a);if(t.setting.tolerance>0)f=t.checkTolorance(o,u);else f=t.checkToloranceDefault(o);if(a)f=t.checkEndOfPage(n);if(f&&!!i)if(this.length>1)this.each(function(){i.apply(this,[f])});else i.apply(this,[f])});return n};e.extend(e.expr[":"],{"in-viewport":function(t,n,r){if(!!r[3])return e(t).isInViewport({tolerance:r[3]});else return e(t).isInViewport()}})})(jQuery)